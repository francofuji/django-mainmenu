{% extends "administrar/base_submenu.html" %}   

{% block css %}
  <link type="text/css" rel="stylesheet" href="{{ MEDIA_URL }}css/demo.css"/>
  <link type="text/css" rel="stylesheet" href="{{ MEDIA_URL }}css/ui-lightness/ui.all.css"/>
  <link type="text/css" rel="stylesheet" href="{{ MEDIA_URL }}js/jquery/datatables/media/css/demo_table.css"/>
  
 <style> 
  .dataTables_length{
    float:left;
    margin-bottom:15px;
  }
  .dataTables_filter{
    float:right;
    margin-bottom:15px;
  }
  #lista_usuarios{
    clear:both;
    margin-bottom:10px;
    width: 100% !important;
  }
  
  #lista_usuarios a{
    color: black;
  }    
 
 </style> 
{% endblock %}

{% block script %}
  <script type="text/javascript" src="{{ MEDIA_URL }}js/jquery/jquery-1.4.2.min.js"></script>
  
  <script type="text/javascript" src="{{ MEDIA_URL }}js/jquery/jquery-form.js"></script>
  
  <script type="text/javascript" src="{{ MEDIA_URL }}js/jquery/ui/ui.core.js"></script>
  <script type="text/javascript" src="{{ MEDIA_URL }}js/jquery/ui/ui.draggable.js"></script>
  <script type="text/javascript" src="{{ MEDIA_URL }}js/jquery/ui/ui.resizable.js"></script>
  <script type="text/javascript" src="{{ MEDIA_URL }}js/jquery/ui/ui.dialog.js"></script>
  <script type="text/javascript" src="{{ MEDIA_URL }}js/jquery/i18n/grid.locale-es.js"></script>
  
  <script type="text/javascript" src="{{ MEDIA_URL }}js/jquery/datatables/media/js/jquery.dataTables.js"></script>
  
  
  <script type="text/javascript">
    
    $(document).ready(function(){
      
          $("#select_all").click(function(){
              
              var estado_actual = this.checked;
              
              $("input[name=checkbox]").each(function(){
                this.checked = estado_actual;
              });
          });
          
          $("#dialog_eliminar_usuario").dialog({
            position: ['center','midle'],
            height: 150,
            width:350,
            modal: true,
            autoOpen: false,
            buttons:{
              "Aceptar":function(){
                jQuery("#dialog_eliminar_cliente").dialog('close');
                url = '/clientes/eliminar_cliente/'+jQuery("#id_cliente_eliminar").val();
                window.location.href = url;
              },
              "Cancelar":function(){
                jQuery("#dialog_eliminar_cliente").dialog('close');
              }
        }
      });
      
          $('#lista_usuarios tr').click( function() {
            if ( $(this).hasClass('row_selected') )
              $(this).removeClass('row_selected');
            else
              $(this).addClass('row_selected');
          } );
      
          $("#lista_usuarios").dataTable({
            "oLanguage": {"sUrl": "{{ MEDIA_URL }}js/jquery/datatables/media/language/es_ES.txt"},
            "aoColumnDefs": [ 
                { "bSearchable": false, "bSortable": false, "aTargets": [ 3 ] },
                
            ]       
    } );
      
    })   
    
    
    function EliminarUsuarios()
    {
          var aReturn = new Array();
          $("#lista_usuarios tr.row_selected").each(function(){
            
            aReturn.push( $(this).attr("id") );
          });
          datos = {"idsClientes":aReturn};
		/*
          $.post("{% url clientes_eliminar_multiples_clientes %}", datos, function(){
            window.location.reload();
          });
        */
    }
    
    function agregar_usuario(id_usuario)
    {
        $.get("/administrar/agregar_usuario/"+id_usuario, function(){
			$("#"+id_usuario).remove();
        });
    }
  </script>
{% endblock %}

{% block contenido %}   
     <div>
      <h3>{{ encabezado }}</h>
     </div>
    
    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}
    
     <div class='content modif_content '>
        <table id="lista_usuarios" class="article" width="700" border="0" cellspacing="0" cellpadding="0">
          <thead>
            <tr>
              <th style='text-align:center;'>Usuario</th>
              <th style='text-align:center;'>Nombre completo</th>
              <th style='text-align:center;'>Área</th>
              <th style='text-align:center;'>Acción</th>
            </tr>
          </thead>
          <tbody>
         {%for usuario in listado%}
            <tr id="{{ usuario.usuario.0 }}">
              <td width="150">{{ usuario.usuario.0 }}</td>
              <td width="450">{{ usuario.nombreCompleto.0 }}</td>
              <td width="500">{{ usuario.proyecto.0 }}</td>
              <td style="vertical-align: middle;"><center><a title="Agregar usuario" alt="Agregar usuario" href="javascript:agregar_usuario('{{usuario.usuario.0}}')"><img src="{{MEDIA_URL}}imagenes/add.png"></a></center></td>
            </tr>
         {% endfor %}
         </tbody>         
        </table>
   
     </div>

        <button style="padding-left:20px" class="Button" type="button" onclick="javascript:window.location.href='{% url sitio_usuarios_del_sistema %}'">
                   <span class="btn">
                     <span class="t">Volver</span>
                     <span class="r"><span></span></span>
                     <span class="l"></span>
                   </span>
                </button> 
<div id="dialog_eliminar_usuario" title="Eliminar">
  <input type="hidden" id="id_usuario_eliminar" value="" />
  <p style="text-align:center;">¿Está seguro que desea eliminar el usuario? </p> 
</div>

{% endblock %}   